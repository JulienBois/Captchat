<!DOCTYPE html>
<html>
    <head>
        <title>Site cryptage</title>
        <script type="text/javascript" src="https://lig-membres.imag.fr/donsez/cours/exemplescourstechnoweb/js_securehash/md4.js"></script>
        <script type="text/javascript" src="https://lig-membres.imag.fr/donsez/cours/exemplescourstechnoweb/js_securehash/md5.js"></script>
        <script type="text/javascript" src="https://lig-membres.imag.fr/donsez/cours/exemplescourstechnoweb/js_securehash/sha1.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.9.0/sha256.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha512/0.8.0/sha512.min.js"></script>
    </head>
    <body>
        <p>Votre message : <input type="text" id="textToCrypt" placeholder="Entrer le text a crypter"/></p>
        <button onclick="MesHash.signer(document.getElementById('textToCrypt').value)"> Hasher message </button>
        <fieldset>
            <legend>Salage ?</legend>
                <label for="Salage"><input type="checkbox" id="Salage" name="Salage"> Oui</label>
        </fieldset>
        <fieldset>
            <legend>Choisissez votre cryptage</legend>
                <label for="tous"><input type="checkbox" id="tous" name="tous" onclick="selectAll()"> Tous </label>
                <label for="MD4"><input type="checkbox" id="checkMD4" name="MD4"> MD4 </label>
                <label for="MD5"><input type="checkbox" id="checkMD5" name="MD5"> MD5 </label>
                <label for="SHA1"><input type="checkbox" id="checkSHA1" name="SHA1"> SHA1 </label>
                <label for="sha256"><input type="checkbox" id="checkSHA256" name="sha256">sha256</label>
                <label for="SHA512"><input type="checkbox" id="checkSHA512" name="SHA512"> SHA512</label>
        </fieldset>
        <ul>
            <li id="md4"></li>
            <li id="md5"></li>
            <li id="sha1"></li>
            <li id="sha256"></li>
            <li id="sha512"></li>
        </ul>
        <script>

        function selectAll(){
            if(document.getElementById("tous").checked == true){
                document.getElementById("checkMD4").checked = true
                document.getElementById("checkMD5").checked = true
                document.getElementById("checkSHA1").checked = true
                document.getElementById("checkSHA256").checked = true
                document.getElementById("checkSHA512").checked = true
            }
            else{
                document.getElementById("checkMD4").checked = false
                document.getElementById("checkMD5").checked = false
                document.getElementById("checkSHA1").checked = false
                document.getElementById("checkSHA256").checked = false
                document.getElementById("checkSHA512").checked = false
            }
        }

        function ajoutBitParite(chaineHasher){
           
           var chaineHash = calcMD4(chaineHasher);
                   var chaineNombre= chaineHash.replace(/\D/g, '');
                   var somme = 0;
                   for(var position = 0; position < chaineNombre.length; position++){
                       somme +=parseInt(chaineNombre[position]);
                   }
                   if(somme %2 == 0){
                       chaineHash += "1";
                   }
                   else{
                       chaineHash += "0";
                   }
                   return chaineHash;
       }
            class MesHash {

                

    static signer(chaine) {
        if(document.getElementById("Salage").checked)
            chaine +="9531"
        console.log(chaine)
        if(chaine.length > 0)
        {
            if(document.getElementById("checkMD4").checked)
            {
                document.getElementById("md4").innerHTML = "Cryptage md4 : " + ajoutBitParite(calcMD4(chaine));
            }
            if(document.getElementById("checkMD5").checked)
            document.getElementById("md5").innerHTML = "Cryptage md5 : " + ajoutBitParite(calcMD5(chaine))
            if(document.getElementById("checkSHA1").checked)
                document.getElementById("sha1").innerHTML = "Cryptage sha1 :" + ajoutBitParite(calcSHA1(chaine))
            if(document.getElementById("checkSHA256").checked)
                document.getElementById("sha256").innerHTML = "Cryptage sha256 : " + ajoutBitParite(sha256(chaine))
            if(document.getElementById("checkSHA512").checked)
                document.getElementById("sha512").innerHTML = "Cryptage sha512 : " + ajoutBitParite(sha512(chaine))
        }    
    }

      
}
        </script>
    </body>
</html>